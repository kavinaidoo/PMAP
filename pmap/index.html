<!DOCTYPE html>
<html lang="en">
    <head>

        <style>
            * {
                font-family: Arial, Helvetica, sans-serif;
            }
            input {
                width: 200px;
                padding: 5px 5px;
                margin: 8px 0;
                box-sizing: border-box;
            }
            button {
                background-color: #04AA6D;
                border: none;
                color: white;
                padding: 10px 20px;
                text-decoration: none;
                margin: 4px 2px;
                cursor: pointer;
            }
        </style>

        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1.0, user-scalable=no" />
        <title>PMAP Wifi Setup</title>
    </head>
    <body>
    <h3>PMAP WiFi Setup</h1>
    <div id = "ssidpwForm" style="display:block">
        <div>Enter/Update your WiFi details below.</div>
        <br>
        <form method="POST">
            <div>
                <label for="ssid">WiFi Name</label>
                <br>
                <select name="ssid" id="ssid" minlength="1" required>
                </select>
            </div>
            <div>
                <label for="pw">Password</label>
                <br>
                <input name="pw" id="pw" type="password" minlength="8" required/>
            </div>
            <div>
                <button>Save</button>
            </div>
        </form>
    </div>
    <br>
    <div id = "detailsStored" style = "display:none">Details stored. You can now close this browser tab. Tap ⬅️ on pmap.</div>
    <div id = "noNetworksFound" style = "display:none">No WiFi Networks found, click back arrow in pmap and enter setup again to re-scan.</div>
    <div id = "errorInSSIDorPW" style = "display:none">Error in SSID or Password, try again.</div>

    <script>
        function showConnecting(){
            document.getElementById("detailsStored").style = "display:block";
            document.getElementById("ssidpwForm").style = "display:none";
        }
        
        document.getElementById("ssidpwForm").addEventListener("submit", showConnecting);

        ssidElement = document.getElementById("ssid");
        
        ssid_list = [];

        status = '';

        if (ssid_list.length == 0){
            document.getElementById("ssidpwForm").style = "display:none";
            document.getElementById("noNetworksFound").style = "display:block";
        }

        if (status == 'showDetailsStored'){
            document.getElementById("detailsStored").style = "display:block";
            document.getElementById("ssidpwForm").style = "display:none";
            document.getElementById("noNetworksFound").style = "display:none";
        }

        if (status == 'showErrorInSSIDorPW'){
            document.getElementById("errorInSSIDorPW").style = "display:block";
        }



        for (x of ssid_list){
            insert = document.createElement("option");
            insert.text = x;
            insert.value = x;
            ssidElement.appendChild(insert);

        }

    </script>
    
</body>
</html>